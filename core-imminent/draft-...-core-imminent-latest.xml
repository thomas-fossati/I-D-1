<?xml version="1.0" encoding="us-ascii"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!ENTITY RFC2119 SYSTEM "reference.RFC.2119.xml">
  <!ENTITY RFC7252 SYSTEM "reference.RFC.7252.xml">
  <!ENTITY RFC7641 SYSTEM "reference.RFC.7641.xml">
]>

<?xml-stylesheet type="text/xsl" href="rfc2629.xslt"?>

<?rfc compact="yes"?>
<?rfc sortrefs="yes"?>
<?rfc subcompact="no"?>
<?rfc symrefs="yes"?>
<?rfc toc="yes"?>
<?rfc tocdepth="2"?>

<rfc category="info" docName="draft-...-core-imminent-00" ipr="trust200902">

  <front>

    <title abbrev="The 'Imminent' Response Code for CoAP">The 'Imminent' Response Code for the Constrained Application Protocol (CoAP)</title>

    <author initials="P." surname="van der Stok" fullname="Peter van der Stok">
      <organization>consultant</organization>
      <address>
        <phone>+31-492474673 (Netherlands), +33-966015248 (France)</phone>
        <email>consultancy@vanderstok.org</email>
        <uri>www.vanderstok.org</uri>
      </address>
    </author>

    <author initials="K." surname="Hartke" fullname="Klaus Hartke">
      <organization>Universitaet Bremen TZI</organization>
      <address>
        <postal>
          <street>Postfach 330440</street>
          <city>Bremen</city>
          <code>D-28359</code>
          <country>Germany</country>
        </postal>
        <phone>+49-421-218-63905</phone>
        <email>hartke@tzi.org</email>
      </address>
    </author>

    <date />

    <area>ART</area>

    <workgroup>CoRE Working Group</workgroup>

    <abstract>

      <t>
        ...
      </t>

    </abstract>

  </front>

  <middle>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="Introduction">

      <t>
        The Constrained Application Protocol (CoAP) <xref target="RFC7252"/>...
        <vspace blankLines="15"/>
      </t>

      <section title="Terminology">

        <t>
          Readers are expected to be familiar with the terms and concepts
          described in <xref target="RFC7252"/> and <xref target="RFC7641"/>.
        </t>

        <t>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
          "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
          "OPTIONAL" in this document are to be interpreted as described in
          <xref target="RFC2119"/>.
        </t>

      </section>

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="2.06 (Imminent) Responses">

      <t>
        A 2.06 (Imminent) response in reply to a GET request indicates that a
        representation of the target resource is not available yet. The Max-Age
        Option indicates after what time a client should retry its GET request.
        The client MAY observe the resource (<xref target="observing"/>) to be
        notified when the representation becomes available.
      </t>

      <t>
        A 2.06 (Imminent) response in reply to a POST request indicates that the
        result of processing the request is not available yet, for example,
        because the server needs longer to process the request than a client is
        typically willing to wait for a response. The server MUST specify a
        location where the result will become available using the Location-*
        options. To receive the result, the client MAY poll or observe (<xref
        target="observing"/>) the resource at the specified location using a GET
        request. The Max-Age Option indicates how long the client should wait
        before making the GET request.
      </t>

      <t>
        A 2.06 (Imminent) response is cacheable, but not validatable. In reply
        to a GET request, it invalidates any cached response for the target
        resource of the request. In reply to a POST request, it invalidates any
        cached response for the resource specified by the Location-* options.
      </t>

      <t>
        A 2.06 (Imminent) response MAY contain a payload that represents the
        progress of processing the original POST request or any other status
        information. The content format of this representation is specified
        using the Content-Format Option.
      </t>

      <section title="Observing Resources" anchor="observing">

        <t>
          If a client requests to be added to the list of observers of a
          resource <xref target="RFC7641"/> for which a representation is not
          available yet, the server MAY send one or more 2.06 (Imminent)
          notifications. The possible resulting sequence of notifications is
          shown in <xref target="figure-1"/>.
        </t>

        <figure anchor="figure-1" title="Sequence of Notifications">
<artwork align="center"><![CDATA[
      __________       __________       __________
     |          |     |          |     |          |
---->|   2.06   |---->|  2.05 /  |---->|  4.xx /  |
     | Imminent |     |   2.03   |     |   5.xx   |
     |__________|     |__________|     |__________|
        ^   \ \          ^    \           ^
         \__/  \          \___/          /
                \_______________________/
]]></artwork>
        </figure>

      </section>

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="Security Considerations">

      <t>TODO.</t>

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="IANA Considerations">

      <t>
        This document adds the 2.06 (Imminent) response code to the "CoAP
        Response Codes" registry.
      </t>

      <texttable title="New CoAP Response Codes" anchor="response-codes">
        <ttcol align="right">Code</ttcol>
        <ttcol align="left">Description</ttcol>
        <ttcol align="left">Reference</ttcol>

        <c>2.06</c>
        <c>Imminent</c>
        <c>[RFCXXXX]</c>
      </texttable>

    </section>

  </middle>

  <back>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <references title="Normative References">

      &RFC2119;
      &RFC7252;
      &RFC7641;

    </references>

    <!--
    <references title="Informative References">
    </references>
    -->

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

  </back>

</rfc>
