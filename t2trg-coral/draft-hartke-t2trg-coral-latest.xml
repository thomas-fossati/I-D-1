<?xml version="1.0" encoding="us-ascii"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!ENTITY RFC2119 SYSTEM "reference.RFC.2119.xml">
  <!ENTITY RFC5988 SYSTEM "reference.RFC.5988.xml">
  <!ENTITY RFC7049 SYSTEM "reference.RFC.7049.xml">
  <!ENTITY RFC7228 SYSTEM "reference.RFC.7228.xml">
  <!ENTITY RFC7252 SYSTEM "reference.RFC.7252.xml">
  <!ENTITY I-D.hartke-core-apps SYSTEM "reference.I-D.hartke-core-apps.xml">
  <!ENTITY I-D.kelly-json-hal SYSTEM "reference.I-D.kelly-json-hal.xml">
]>

<?xml-stylesheet type="text/xsl" href="rfc2629.xslt"?>

<?rfc compact="yes"?>
<?rfc sortrefs="yes"?>
<?rfc subcompact="no"?>
<?rfc symrefs="yes"?>
<?rfc toc="yes"?>
<?rfc tocdepth="2"?>

<rfc category="exp" docName="draft-hartke-t2trg-coral-01" ipr="trust200902">

  <front>

    <title abbrev="CoRAL">The Constrained RESTful Application Language (CoRAL)</title>

    <author initials="K." surname="Hartke" fullname="Klaus Hartke">
      <organization>Universitaet Bremen TZI</organization>
      <address>
        <postal>
          <street>Postfach 330440</street>
          <city>Bremen</city>
          <code>D-28359</code>
          <country>Germany</country>
        </postal>
        <phone>+49-421-218-63905</phone>
        <email>hartke@tzi.org</email>
      </address>
    </author>

    <date />

    <workgroup>Thing-to-Thing Research Group</workgroup>

    <abstract>

      <t>
        The Constrained RESTful Application Language (CoRAL) is a compact,
        binary representation format for building RESTful, hypermedia-driven
        applications that run in constrained environments.
      </t>

    </abstract>

  </front>

  <middle>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="Introduction">

      <t>
        Constrained RESTful Environments (CoRE) realize the
        <xref target="WEBARCH">Web architecture</xref> in a suitable form for
        <xref target="RFC7228">constrained nodes and networks</xref>.
      </t>

      <t>
        In the Web, hypertext documents contain links and forms that allow a
        user to navigate between resources and submit information to a server
        for processing.  By annotating these elements with machine-readable
        <xref target="RFC5988">link relation types</xref> and form relation
        types, it is possible to extend this interaction model to
        machine-to-machine communication.
      </t>

      <t>
        This document describes the Constrained RESTful Application Language
        (CoRAL), a serialization format for Web links and forms that is based
        on the <xref target="RFC7049">Concise Binary Object Representation
        (CBOR)</xref>. The format also supports the embedding of representations
        of resources. Thus, CoRAL can be used as a building block for RESTful,
        hypermedia-driven applications.
      </t>

      <section title="Terminology">

        <t>
          Readers are expected to be familiar with the terms and
          concepts described in <xref target="RFC5988"/> and
          <xref target="I-D.hartke-core-apps"/>.
        </t>

        <t>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
          RECOMMENDED", "MAY", and "OPTIONAL" in this document are
          to be interpreted as described in <xref target="RFC2119"/>.
        </t>

      </section>

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="Overview">

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="Data Format" anchor="format">

      <figure>
        <artwork type="cddl">
<![CDATA[   document     = [*element]
   element      = tiny-link / tiny-literal / tiny-form
                / fat-link  / fat-literal  / fat-form
                / base

   tiny-link    = [1, href-type, relation]
   tiny-literal = [2, href-type, relation, format, body]
   tiny-form    = [3, href-type, relation, accept]
   base         = [4, href-type, options]
   fat-link     = [5, href-type, options, ?body]
   fat-literal  = [6, href-type, options, ?body]
   fat-form     = [7, href-type, options, ?body]

   href-type    = &(append-relation: 0,
                    absolute-path: 1,
                    append-path: 2,
                    relative-path: 3)

   relation     = uint
   format       = uint
   accept       = uint
   options      = [*(delta, value)]
   delta        = uint
   value        = uint / text / bytes
   body         = bytes]]>
        </artwork>
      </figure>

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="Options">

      <t>
        The CoRAL options defined in this document are summarized in
        <xref target="table-options"/> below and explained in the following
        subsections:
      </t>

      <texttable title="Options" anchor="table-options">
        <ttcol align="right">No.</ttcol>
        <ttcol>R</ttcol>
        <ttcol>Name</ttcol>
        <ttcol>Format</ttcol>
        <ttcol>Length</ttcol>
        <ttcol>Default</ttcol>

        <c>  1</c><c>x</c><c>Relation      </c><c>uint  </c><c>0-2   </c><c>(none)     </c>
        <c>  2</c><c>x</c><c>Relation.Local</c><c>uint  </c><c>0-2   </c><c>(none)     </c>
        <c>  3</c><c> </c><c>Method        </c><c>uint  </c><c>1     </c><c>2 (POST)   </c>
        <c>  4</c><c>x</c><c>Accept        </c><c>uint  </c><c>0-2   </c><c>(none)     </c>
        <c>  5</c><c>x</c><c>Accept.Local  </c><c>uint  </c><c>0-2   </c><c>(none)     </c>
        <c>  6</c><c>x</c><c>Format        </c><c>uint  </c><c>0-2   </c><c>(none)     </c>
        <c>  7</c><c>x</c><c>Format.Local  </c><c>uint  </c><c>0-2   </c><c>(none)     </c>
        <c>  8</c><c> </c><c>Href.Scheme   </c><c>string</c><c>1-255 </c><c>(none)     </c>
        <c>  9</c><c> </c><c>Href.Host.Name</c><c>string</c><c>1-255 </c><c>(none)     </c>
        <c> 10</c><c> </c><c>Href.Host.IPv4</c><c>opaque</c><c>4     </c><c>(none)     </c>
        <c> 11</c><c> </c><c>Href.Host.IPv6</c><c>opaque</c><c>16    </c><c>(none)     </c>
        <c> 12</c><c> </c><c>Href.Port     </c><c>uint  </c><c>0-2   </c><c>(see below)</c>
        <c> 13</c><c>x</c><c>Href.Path     </c><c>string</c><c>0-255 </c><c>(none)     </c>
        <c> 14</c><c>x</c><c>Href.Query    </c><c>string</c><c>0-255 </c><c>(none)     </c>
        <c> 15</c><c> </c><c>Href.Fragment </c><c>string</c><c>0-255 </c><c>(empty)    </c>
        <c> 16</c><c> </c><c>Title         </c><c>string</c><c>0-255 </c><c>(none)     </c>
        <c> 17</c><c> </c><c>Updatable     </c><c>empty </c><c>0     </c><c>(none)     </c>
        <c> 18</c><c> </c><c>Deletable     </c><c>empty </c><c>0     </c><c>(none)     </c>
      </texttable>

      <t>
        The option properties are defined as follows:
        <list style="hanging">
          <t hangText="Number:">
            An option is identified by an option number.
          </t>
          <t hangText="Repeatable (R):">
            An option that is repeatable MAY be included one or more times in an
            element. An option that is not repeatable MUST NOT be included more
            than once. If an agent encounters an option with more occurrences
            than the option is defined for, each supernumerary option occurrence
            MUST be ignored.
          </t>
          <t hangText="Format:">
            Option values are defined to have a certain format. In the same
            manner as the types defined in Section 3.2 of
            <xref target="RFC7252"/>, "string" stands for a text string;
            "opaque" for a byte string, and "uint" for an unsigned integer.
          </t>
          <t hangText="Length:">
            Option values are defined to have a specific length, often in the
            form of an upper and lower bound. For unsigned integer options the
            length is counted as the number of bytes that would be needed to
            represent the unsigned integer as a binary number. The length of an
            option value MUST NOT be outside the defined range. If an agent
            encounters an option with a length outside the defined range, that
            option MUST be ignored.
          </t>
          <t hangText="Default Value:">
            Options may be defined to have a default value.  If the value of an
            option is intended to be this default value, the option SHOULD NOT
            be included in the element. If the option is not present, the
            default value MUST be assumed.
          </t>
        </list>
      </t>

      <section title="Accept.*"></section>
      <section title="Format.*"></section>
      <section title="Href.*"></section>
      <section title="Method"></section>
      <section title="Title"></section>
      <section title="Updatable"></section>
      <section title="Deletable"></section>

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="Reference Resolution" anchor="resolution">

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="Security Considerations" anchor="security">

      <t>
        TODO.
      </t>

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="IANA Considerations">

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

  </middle>

  <back>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <references title="Normative References">

      &RFC2119;
      &RFC5988;
      &RFC7049;
      &RFC7252;
      &I-D.hartke-core-apps;

    </references>

    <references title="Informative References">

      &RFC7228;
      &I-D.kelly-json-hal;

      <reference anchor="WEBARCH" target="http://www.w3.org/TR/2004/REC-webarch-20041215">
        <front>
          <title>Architecture of the World Wide Web, Volume One</title>
          <author initials="I." surname="Jacobs" fullname="Ian Jacobs"/>
          <author initials="N." surname="Walsh" fullname="Norman Walsh"/>
          <date month="December" day="15" year="2004" />
        </front>
        <seriesInfo name="World Wide Web Consortium Recommendation" value="REC-webarch-20041215" />
        <format type="HTML" target="http://www.w3.org/TR/2004/REC-webarch-20041215" />
      </reference>

    </references>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

    <section title="Acknowledgements" numbered="no">

      <t>
        This specification is heavily inspired by the
        <xref target="I-D.kelly-json-hal">JSON Hypertext Application Language
        (HAL)</xref>; the author of and contributors to that specification are
        acknowledged for their great work.
      </t>

      <t>
        Yassin Nasir Hassan suggested placing the hypermedia controls for
        modifying a link target in the link context rather than in the
        representation of the link target.
      </t>

      <t>
        Carsten Bormann contributed the CDDL grammar and CBOR examples.
      </t>

      <!--
      <t>
        The author would like to thank
        X,
        Y, and
        Z
        for helpful comments and discussions that have shaped the
        document.
      </t>
      -->

    </section>

    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->
    <!-- **************************************************************** -->

  </back>

</rfc>
